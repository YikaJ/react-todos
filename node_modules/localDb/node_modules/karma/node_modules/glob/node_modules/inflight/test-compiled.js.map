{"version":3,"sources":["test.js"],"names":[],"mappings":";;AAAA,IAAI,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,CAAA;AAC9B,IAAI,GAAG,GAAG,OAAO,CAAC,eAAe,CAAC,CAAA;;AAGlC,SAAS,GAAG,CAAE,GAAG,EAAE,EAAE,EAAE;AACrB,IAAE,GAAG,GAAG,CAAC,GAAG,EAAE,EAAE,CAAC,CAAA;AACjB,MAAI,EAAE,EAAE,UAAU,CAAC,YAAY;AAC7B,MAAE,CAAC,GAAG,CAAC,CAAA;AACP,MAAE,CAAC,GAAG,CAAC,CAAA;GACR,CAAC,CAAA;AACF,SAAO,EAAE,CAAA;CACV;;AAED,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC,EAAE;AACzB,MAAI,OAAO,GAAG,KAAK,CAAA;AACnB,MAAI,CAAC,GAAG,GAAG,CAAC,KAAK,EAAE,UAAU,CAAC,EAAE;AAC9B,KAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAA;AAChB,WAAO,GAAG,IAAI,CAAA;AACd,KAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAA;AACjB,QAAI,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAA;GACrB,CAAC,CAAA;AACF,GAAC,CAAC,EAAE,CAAC,CAAC,EAAE,4BAA4B,CAAC,CAAA;;AAErC,MAAI,OAAO,GAAG,KAAK,CAAA;AACnB,MAAI,CAAC,GAAG,GAAG,CAAC,KAAK,EAAE,UAAU,CAAC,EAAE;AAC9B,KAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAA;AAChB,WAAO,GAAG,IAAI,CAAA;AACd,KAAC,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,CAAA;AACjB,QAAI,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAA;GACrB,CAAC,CAAA;;AAEF,GAAC,CAAC,KAAK,CAAC,CAAC,EAAE,4CAA4C,CAAC,CAAA;CACzD,CAAC,CAAA;;AAEF,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,EAAE;AAC1B,MAAI,MAAM,GAAG,CACX,YAAY,EACZ,WAAW,EACX,SAAS,EACT,KAAK,EACL,MAAM,EACN,OAAO,CACR,CAAA;AACD,MAAI,CAAC,GAAG,CAAC,CAAA;;AAET,WAAS,GAAG,CAAE,CAAC,EAAE;AACf,KAAC,CAAC,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAA;AAC9C,MAAE,CAAC,CAAA;AACH,QAAI,CAAC,KAAK,MAAM,CAAC,MAAM,EACrB,CAAC,CAAC,GAAG,EAAE,CAAA;GACV;;AAED,WAAS,MAAM,CAAE,IAAI,EAAE,EAAE,EAAE;AACzB,OAAG,CAAC,SAAS,GAAG,IAAI,CAAC,CAAA;AACrB,WAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAA;GACrB;;AAED,MAAI,GAAG,GAAG,GAAG,CAAC,KAAK,EAAE,YAAY;AAC/B,OAAG,CAAC,WAAW,CAAC,CAAA;AAChB,QAAI,KAAK,GAAG,GAAG,CAAC,KAAK,EAAE,YAAY;AACjC,SAAG,CAAC,OAAO,CAAC,CAAA;KACb,CAAC,CAAA;AACF,QAAI,KAAK,EAAE,MAAM,CAAC,OAAO,EAAE,KAAK,CAAC,CAAA;AACjC,OAAG,CAAC,SAAS,CAAC,CAAA;GACf,CAAC,CAAA;;AAEF,QAAM,CAAC,KAAK,EAAE,GAAG,CAAC,CAAA;;AAElB,MAAI,GAAG,GAAG,GAAG,CAAC,KAAK,EAAE,YAAY;AAC/B,OAAG,CAAC,KAAK,CAAC,CAAA;GACX,CAAC,CAAA;AACF,MAAI,GAAG,EAAE,MAAM,CAAC,KAAK,EAAE,GAAG,CAAC,CAAA;;AAE3B,SAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC,CAAA;CACzC,CAAC,CAAA;;AAEF,IAAI,CAAC,YAAY,EAAE,UAAU,CAAC,EAAE;AAC9B,GAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;;AAET,MAAI,CAAC,GAAG,GAAG,CAAC,KAAK,EAAE,UAAU,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE;AACjD,KAAC,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;AACjB,KAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAA;AAClB,KAAC,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;GAClB,CAAC,CAAA;AACF,GAAC,CAAC,EAAE,CAAC,CAAC,EAAE,4BAA4B,CAAC,CAAA;;AAErC,MAAI,CAAC,GAAG,GAAG,CAAC,KAAK,EAAE,UAAU,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE;AACjD,KAAC,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;AACjB,KAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAA;AAClB,KAAC,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;GAClB,CAAC,CAAA;AACF,GAAC,CAAC,KAAK,CAAC,CAAC,EAAE,4CAA4C,CAAC,CAAA;;AAExD,YAAU,CAAC,YAAY;AACrB,KAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;GACX,CAAC,CAAA;CACH,CAAC,CAAA","file":"test-compiled.js","sourcesContent":["var test = require('tap').test\nvar inf = require('./inflight.js')\n\n\nfunction req (key, cb) {\n  cb = inf(key, cb)\n  if (cb) setTimeout(function () {\n    cb(key)\n    cb(key)\n  })\n  return cb\n}\n\ntest('basic', function (t) {\n  var calleda = false\n  var a = req('key', function (k) {\n    t.notOk(calleda)\n    calleda = true\n    t.equal(k, 'key')\n    if (calledb) t.end()\n  })\n  t.ok(a, 'first returned cb function')\n\n  var calledb = false\n  var b = req('key', function (k) {\n    t.notOk(calledb)\n    calledb = true\n    t.equal(k, 'key')\n    if (calleda) t.end()\n  })\n\n  t.notOk(b, 'second should get falsey inflight response')\n})\n\ntest('timing', function (t) {\n  var expect = [\n    'method one',\n    'start one',\n    'end one',\n    'two',\n    'tick',\n    'three'\n  ]\n  var i = 0\n\n  function log (m) {\n    t.equal(m, expect[i], m + ' === ' + expect[i])\n    ++i\n    if (i === expect.length)\n      t.end()\n  }\n\n  function method (name, cb) {\n    log('method ' + name)\n    process.nextTick(cb)\n  }\n\n  var one = inf('foo', function () {\n    log('start one')\n    var three = inf('foo', function () {\n      log('three')\n    })\n    if (three) method('three', three)\n    log('end one')\n  })\n\n  method('one', one)\n\n  var two = inf('foo', function () {\n    log('two')\n  })\n  if (two) method('one', two)\n\n  process.nextTick(log.bind(null, 'tick'))\n})\n\ntest('parameters', function (t) {\n  t.plan(8)\n\n  var a = inf('key', function (first, second, third) {\n    t.equal(first, 1)\n    t.equal(second, 2)\n    t.equal(third, 3)\n  })\n  t.ok(a, 'first returned cb function')\n\n  var b = inf('key', function (first, second, third) {\n    t.equal(first, 1)\n    t.equal(second, 2)\n    t.equal(third, 3)\n  })\n  t.notOk(b, 'second should get falsey inflight response')\n\n  setTimeout(function () {\n    a(1, 2, 3)\n  })\n})\n"]}